@page "/counter"
@using Store
@inject CounterStore Store
@implements IDisposable
@functions {

    protected override void OnInit()
    {
        Store.StateHasChanged += HandleStateChange;
        base.OnInit();
    }

    public void HandleStateChange(object sender, EventArgs e)
    {
        this.StateHasChanged();
    }

    public void Dispose()
    {
        Store.StateHasChanged -= HandleStateChange;
    }
}

<!--VIEW-->
<h1>Counter</h1>
<p>Count per second: @Store.Counter.CountPerSecond</p>
<p>Current count: @Store.GetCount()</p>

<button @onclick(Store.IncrementCount)>Click me</button>
<br />
@foreach (var item in Store.Counter.Buildings)
{
    <p>@item.Name (Adds @item.AmountPerSecond clicks/second) </p>
    <p>Owned: @item.AmountOwned <button @onclick(() => Store.BuyBuilding(item.Id))>Buy (Cost: @item.Cost)</button></p>
}